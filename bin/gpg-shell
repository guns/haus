#!/bin/sh

export GPG_TTY="$(tty)"

PINENTRY_PROGRAM=

if [ "$(id -u)" -eq 0 ] || [ -n "$SSH_TTY" ]; then
    PINENTRY_PROGRAM='--pinentry-program=/usr/bin/pinentry-curses'
fi

if [ "$#" -eq 0 ]; then
    exec gpg-agent --enable-ssh-support $PINENTRY_PROGRAM --daemon "${SHELL:-$(command -v bash)}"
else
    exec gpg-agent --enable-ssh-support $PINENTRY_PROGRAM --daemon "$@"
fi
