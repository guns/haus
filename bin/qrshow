#!/usr/bin/env ruby

case ARGV.size
when 0
  input = $stdin.read
when 1
  input = File.read ARGV[0]
else
  abort "USAGE: #{File.basename __FILE__} [path]"
end

progname = File.basename __FILE__

require 'tempfile'

Tempfile.open progname do |tmp|
  tmp.close

  IO.popen ['qrencode', '-o', tmp.path], 'w' do |io|
    io.write input
  end

  system 'sxiv', '-g', '200x200', '-N', progname, tmp.path
end
