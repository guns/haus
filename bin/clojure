#!/usr/bin/env bash
#
# Clojure wrapper.
#
# http://trac.macports.org/browser/trunk/dports/lang/clojure/files/clj-rlwrap.sh?format=txt

[[ -d "$cdjars" ]] && CLASSPATH="$cdjars/clojure.jar:$CLASSPATH"
CLOJURE="java -client -classpath $CLASSPATH clojure.main"
BREAK_CHARS="(){}[],^%\$#@\"';:|\\"
COMPLETIONS=~/.clj_completions

if (($#)); then
    exec $CLOJURE "$@"
else
    touch "$COMPLETIONS"
    exec run rlwrap --case-insensitive \
                    --break-chars "$BREAK_CHARS" \
                    --quote-characters '"' \
                    --complete-filenames \
                    --remember \
                    --file "$COMPLETIONS" \
                    $CLOJURE
fi
