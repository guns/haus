#!/usr/bin/env bash
#
# Clojure wrapper.

CLASSPATH="$HOME/.clojure/clojure.jar:$CLASSPATH"
CLOJURE_CMD="java -server -classpath $CLASSPATH clojure.main"
BREAK_CHARS="(){}[],^%\$#@\"';:|\\"

if [[ "$1" == '--repl' && -e ~/.clojure/project.clj ]]; then
    echo cd ~/.clojure
    cd ~/.clojure
    exec run lein repl
elif (($#)); then
    exec run $CLOJURE_CMD "$@"
else
    exec run rlwrap --ansi-colour-aware \
                    --prompt-colour=GREEN \
                    --case-insensitive \
                    --break-chars "$BREAK_CHARS" \
                    --quote-characters '"' \
                    --complete-filenames \
                    --remember \
                    $CLOJURE_CMD
fi
